<!DOCTYPE html>
<html lang="en" xmlns:th="https://www.thymeleaf.org/">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AutoFlex</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    
    <script
      src="https://kit.fontawesome.com/c73c7e0ed2.js"
      crossorigin="anonymous"
    ></script>
  </head>
  <body class="bg-body-tertiary">
    <div class="container my-2 px-md-5 px-4">
      <div class="col-md-8 mx-auto">
		<form 
			th:action="@{/saveuser}"
              th:object="${user}"
              method="post"
              enctype="multipart/form-data"
              class="needs-validation"
      		  novalidate
              >

          <div class="row">
            <div class="col">
              <h1 class="h1 text-center fw-medium mb-4 mt-3 fw-bold">Welcome to AutoFlex</h1>
              <h1 class="h4 mb-3 fw-normal">Please Sign Up</h1>
              <th:block th:if="${session.message}" class="my-2">
                <div
                  th:classappend="${'alert-'+session.message.type}"
                  class="alert alert-dismissible fade show"
                  role="alert"
                >
                  <span th:text="${session.message.content}"></span>
                  <button
                    type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                    aria-label="Close"
                  ></button>
                </div>
              </th:block>
            </div>
          </div>

<div class="row border-top">
        <div class="col-md-4 mt-3 bg-pattern">
            <div class="mb-3 form-floating">
                <select class="form-select" name="role" id="role" th:field="*{role}" aria-label="Floating label select example" required>
                    <option value="customer">Customer</option>
                    <option value="owner">Car Owner</option>
                </select>
                <label for="role">Select Your Role</label>
                <div class="invalid-feedback">Please select a role.</div>
            </div>
        </div>
        <div class="col-md-8 mt-md-3">
            <div class="form-floating mb-3">
                <input type="email" class="form-control" id="email" name="email" th:field="*{email}" placeholder="name@example.com" required />
                <label for="email">Email address</label>
                <div class="invalid-feedback">Please enter a valid email address.</div>
            </div>
        </div>
    </div>

          <div class="row">
            <div class="col-12 col-md-6">
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="first name"
                  name="firstName"
                  th:field="*{firstName}"
                  placeholder="First Name"
                  required="required"
                />
                <label for="first name">First Name</label>
              </div>
            </div>
            <div class="col-12 col-md-6">
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="last name"
                  name="lastName"
                  th:field="*{lastName}"
                  placeholder="Last Name"
                />
                <label for="last name">Last Name</label>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12 col-md-6">
              <div class="form-floating mb-3">
                <input
                  type="text"
                  class="form-control"
                  id="location"
                  name="city"
                  th:field="*{city}"
                  placeholder="location"
                  required="required"
                />
                <label for="location">City</label>
              </div>
            </div>
            <div class="col-12 col-md-6">
              <div class="form-floating mb-3">
                <input
                  type="tel"
                  name="contactNumber"
                  class="form-control"
                  id="phone"
                  th:field="*{contactNumber}"
                  placeholder="000000000"
                  required="required"
                />
                <label for="phone">Contact number</label>
              </div>
            </div>
          </div>

    <div class="row">
        <div class="col-12 col-md-6">
            <div class="form-floating mb-3">
                <input type="password" class="form-control" id="password" name="password" th:field="*{password}" placeholder="password" required onchange="validatePassword()" />
                <label for="password">Password</label>
                <div class="invalid-feedback">Password length should be greater than 8 characters.</div>
            </div>
        </div>
        <div class="col-12 col-md-6">
            <div class="form-floating mb-3">
                <input type="password" class="form-control" id="confirmPassword" name="confirmPassword" placeholder="confirm password" required oninput="validateConfirmPassword()" />
                <label for="confirmPassword">Confirm Password</label>
                <div class="invalid-feedback">Passwords do not match.</div>
            </div>
        </div>
    </div>

          
	    <div class="row">
	        <div class="col-12 mb-3">
	            <label for="image" class="form-label mb-2">Upload Picture</label>
	            <input type="file" name="image" class="form-control" accept="image/*" required="required">
	        </div>
	    </div>
            
          <div class="row border-top py-3">
          	<div class="col-12 col-md-6 text-start">
              <p
                class="my-3 fw-normal d-flex justify-content-start justify-content-md-start align-items-center"
              >
                Already registered?
                <a class="nav-link text-primary px-2" href="/login">Sign In</a>
              </p>
            </div>
          
            <div class="col-12 col-md-6 d-flex  justify-content-between align-items-center">
              <a class="btn btn-outline-dark w-50 mx-2 py-2 btn-lg" href="/">
                Back
              </a>
              <button class="btn btn-primary w-50 mx-2 py-2 btn-lg" type="submit">
                Register
              </button>
            </div>

  
          </div>
        </form>
      </div>
                <p class="my-5  text-center mb-2 text-body-secondary">
              Â© 2024 AutoFlex, Inc
            </p>
    </div>



<script>
    (() => {
        'use strict';

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        const forms = document.querySelectorAll('.needs-validation');

        // Loop over them and prevent submission
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }

                // Bootstrap validation
                Array.from(form.elements).forEach(input => {
                    if (input.checkValidity() === false) {
                        input.classList.add('is-invalid');
                    } else {
                        input.classList.remove('is-invalid');
                    }
                });

                // Custom password validation
                const passwordInput = form.querySelector('#password');
                const confirmPasswordInput = form.querySelector('#confirmPassword');
                const password = passwordInput.value;
                const confirmPassword = confirmPasswordInput.value;

                if (password.length < 8) {
                    passwordInput.setCustomValidity('Password must be at least 8 characters long.');
                } else {
                    passwordInput.setCustomValidity('');
                }

                if (password !== confirmPassword) {
                    confirmPasswordInput.setCustomValidity('Passwords do not match.');
                } else {
                    confirmPasswordInput.setCustomValidity('');
                }

                form.classList.add('was-validated');
            }, false);

            // Additional event listeners to remove Bootstrap validation classes on input/change
            form.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', () => {
                    input.classList.remove('is-invalid');
                });
            });
        });
    })();
</script>

	

	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
   
    <script
      src="/docs/5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
